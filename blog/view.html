<!doctype html>
<html><!-- InstanceBegin template="/Templates/TEDxNCCU.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta charset="utf-8">
<link rel="shortcut icon" type="image/x-icon" href="http://1.gravatar.com/blavatar/5eb168b0154768602b7da05b54081381?s=16" sizes="16x16">
<link rel="icon" type="image/x-icon" href="http://1.gravatar.com/blavatar/5eb168b0154768602b7da05b54081381?s=16" sizes="16x16">
<!-- InstanceBeginEditable name="head1" -->
<title>TEDxNCCU</title>



<!-- InstanceEndEditable -->
<link href="../css/jquery-ui.css" rel="stylesheet" type="text/css">
<!--link href="css/bootstrap.min.css" rel="stylesheet" type="text/css"-->
<link href="../css/reset.css" rel="stylesheet" type="text/css">
<!--link href="css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"-->
<link href="../css/tedxnccu2.css" rel="stylesheet" type="text/css">
<!-- InstanceBeginEditable name="head2" -->
<style>
img.l { float:left; width:300px; margin:20px 20px 20px 0;}
img.r { float:right; width:300px;  margin:20px 0 20px 20px;}
img.m { width:100%;}
b { font-weight:bold;}

</style>
<!-- InstanceEndEditable -->
</head>
<body>

<nav>
	<div id="nav" class="container clearfix">
		<div style="float:left;">
			<a href="../index.html"><img src="../img/TEDxNCCU5.png" height="30" style="margin:8px 0px 3px 0px;"></a>
		</div>
		<div style="float:right">
			<ul id="mainNav" class="hrzUL clearfix">
				<li class="withSubNav clearfix">
					<a href="../acts/index.html">TED活動</a>
					<ul class="subNav">
						<li><a href="#">2013 From Idea To Action</a></li>
					</ul>
				</li>
				<li class="withSubNav clearfix">
					<a href="index.html">文章分享</a>
					<ul class="subNav">
						<li><a href="blog.html">部落格</a></li>
						<li><a href="tedtalk.html">TED TALK</a></li>
						<li><a href="act.html">活動成果</a></li>
					</ul>
				</li>
								<li><a href="../spnsors.html">贊助夥伴</a>	</li>
				<li><a href="../aboutTEDx.html">關於TEDx</a></li>	
				<li class="withSubNav clearfix"><a href="../about.html">關於我們</a>
					<ul class="subNav">
						<li><a href="../members.html">團隊介紹</a></li>
						<li><a href="#">團隊理念</a></li>
						<li><a href="../contact.html">聯繫我們</a></li>
					</ul>
				</li>
				<li><a href="https://www.facebook.com/tedxnccu">FaceBook</a></li>
	
			</ul>
		</div>
	</div>
</nav>
<div style="width:100%; height:44px;">
</div>
<!-- InstanceBeginEditable name="content" -->
<div id="banner">
	<div class="bannerPic-small-cover">
		<div class="container">
			<div class="title">
				<h1>TEDxNCCU 部落格</h1>
			</div>
			<div style="padding:10px; color:white; display:block; ">
				TEDxNCCU 文章分享 >> 部落格 >> <span id="bread"></span>
			</div>
		</div>
	</div>
	<div class="bannerPic-small">
	</div>
</div>
<style>

</style>


<div class="outer bg" style="padding-top">
	<div class="container">
		<div class="shd block">
			<div class="control-outer" style="display:none; height:40px; " >
				<ul class="clearfix admin-btns" style="top:20px; right:20px;">
					<li style="margin-right:20px;"><a id="admin-btn-edit" class="admin-btn" href="#" title="編輯"><img width="20" src="../img/btns/edit.png"></a></li>
					<li><a id="admin-btn-bin" class="admin-btn" href="#" title="刪除"><img width="15" src="../img/btns/bin.png"></a></li>
				</ul>
			</div>
			<!--div style="width:100%; background:rgba(255,0,0,1);">

			</div-->
			<div class="box apdArea" >
			</div>
		</div>
	</div>
</div>

<div class="container">
<!--for edit-->
	<form class="pageForm" action="edit.html" method="get">
		<input id="pageInput1" name="blog" hidden="true" value="0" style="display:none;">
		<input id="pageInput2" name="db" hidden="true" value="0" style="display:none;">
	</form>
</div>

<!-- InstanceEndEditable -->


<footer class="outer-small">
	<div class="container clearfix">
		<ul class="hrzUL foot_nav">
			<li><a href="../acts/index.html">From Idea to Action</a></li>
			<li><a href="../contact.html">聯絡我們</a></li>
			<li><a href="../manage/login.html">管理模式</a></li>
		</ul>
	</div>
</footer>

<!-- InstanceBeginEditable name="content-aft" -->
<!-- InstanceEndEditable -->


<!-- InstanceBeginEditable name="js-1" -->
<script type="text/javascript">
</script>
<!-- InstanceEndEditable -->
<script src="../js/jquery.min.js" type="text/javascript"></script>
<script src="../js/jquery-ui.js" type="text/javascript"></script>
<!--script src="js/bootstrap.min.js" type="text/javascript"></script-->
<script src="../js/parse-1.2.8.min.js" type="text/javascript"></script>
<script src="../js/TEDxNCCU.js" type="text/javascript"></script> 
<!-- InstanceBeginEditable name="js-2" -->
<script type="text/javascript">
Parse.initialize("BFuEvRNBwRW6MScfT6nIUrhZaKMBriF4VpAC0DwD", "MvYBNO5NQ6DeixPpLgmH60wQDQvQrf5nIrx6RHgy");




var currentUser = Parse.User.current();
var theBlog;
var blogId;
var blog;
var dataBase;
var db;
$(document).ready(function(e) {
	if(currentUser)$('.control-outer').show();
	blogId = getURLParameter('blog');
	db = getURLParameter('db');
	console.log (typeof(blogId));
	
	switch (db){
		case 'G' : dataBase = 	Parse.Object.extend("TEDxBLOG_grass");break;
		case 'B' : dataBase = 	Parse.Object.extend("TEDxBLOG_back");break;
		default  : dataBase = 	Parse.Object.extend("TEDxBLOG");
	}

	if (blogId !== 'null'){pullBlog (blogId);}
	else {show({'subject':"請先選取文章"});}
	//'My4BYgu7Il' ;//(getURLParameter('blog'));

	if (currentUser) {
		
		
		
		
	}
	
});

function getURLParameter(name) {
	return decodeURI(
		(RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
	);
}

var $apd = $('.apdArea');
function pullBlog (blogId) {
	var TEDxBLOG = dataBase;
	var query = new Parse.Query(TEDxBLOG);
	query.get(blogId,{
		success:function (o){
			theBlog = o;
			blog = getBlog (o);
			show (blog);
		},
		error:function (o,e){
			alert('');
		}	
	})
}

function getBlog (o){
	var obj = {
		'subject': o.get('subject'),
		'type': o.get('type'),
		'writer': o.get('writer'),
		'date': o.get('date'),
		'preImg': o.get('preImg'),
		'abstract': o.get('abstract'),
		'content': o.get('content'),
		'id':o.id
	}
	return obj;
}
	
function show (blog){
	if (!blog.subject) {alert ('資料庫問題，請先參閱其他文章'); return false}
	$apd.append('<h2>'+blog.subject+'</h2>').append(blog.content);			
	$('title').text(blog.subject +'--TEDxNCCU 部落格');	
	$('#bread').text(blog.subject);
	if (!blog.id) {$apd.append('<a href="index.html" style="display:block; margin:40px 0px;">回文章列表</a>');}
}


// edit or delete func 
$('#admin-btn-edit').click(function (e){
	$('#pageInput1').val(blogId);
	$('#pageInput2').val(db);
	$('.pageForm').submit();
	console.log ('!!');
	return false;
});
$('#admin-btn-bin').click(function (e){
	var a = confirm ('點擊後文章會立刻刪除，你確定嗎?');
	if (a)theBlog.destroy({success:function (){
		alert ('刪除成功'); 
		switch (db){
			case 'G' : dataBase = 	window.location = "grass.html";break;
			case 'B' : dataBase = 	window.location = "back.html";break;
			default  : dataBase = 	window.location = "index.html"
		}
	}});
});

</script>
<!-- InstanceEndEditable -->
</body>
<!-- InstanceEnd --></html>
